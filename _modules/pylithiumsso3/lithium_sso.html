<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pylithiumsso3.lithium_sso &mdash; pylithiumsso3  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> pylithiumsso3
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pylithiumsso3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>pylithiumsso3.lithium_sso</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pylithiumsso3.lithium_sso</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Python implementation of ``lithium_sso.php``. License information provided by</span>
<span class="sd">Khoros, LLC:</span>

<span class="sd">    LICENSE FILE DISCLOSURE STATEMENT</span>
<span class="sd">    =============================================</span>
<span class="sd">    This LICENSE.TXT file sets forth the general licensing terms and references for the</span>
<span class="sd">    SSOClient Java software provided by Khoros, LLC. Your use of the software components</span>
<span class="sd">    provided herewith (the “Software”) is subject to the terms set forth herein and any</span>
<span class="sd">    associated license that you have entered into with Khoros.  Except as may be granted</span>
<span class="sd">    by separate express written agreement, this file provides no license to any Lithium</span>
<span class="sd">    patents, trademarks, copyrights, or other intellectual property.</span>

<span class="sd">    =======================================</span>
<span class="sd">     Khoros, LLC Copyright Notice</span>
<span class="sd">    =======================================</span>

<span class="sd">    SSOClient.java</span>

<span class="sd">    Copyright (c) 2022 Khoros, LLC, Austin, Texas, U.S.A. All Rights Reserved</span>

<span class="sd">    The Software is the confidential and proprietary information of Khoros, LLC</span>
<span class="sd">    (“Confidential Information”).  You shall not disclose such Confidential Information</span>
<span class="sd">    and shall use it only in accordance with the terms of the license agreement you</span>
<span class="sd">    entered into with Lithium.</span>

<span class="sd">Example Usage:</span>

<span class="sd">.. code-block:: python</span>

<span class="sd">    # Secret SSO key (128-bit or 256-bit) provided by Lithium</span>
<span class="sd">    sso_key = &quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span>

<span class="sd">    # (Optional) Secret PrivacyGuard key (128-bit or 256-bit) *NOT* to be shared with Lithium</span>
<span class="sd">    pg_key = &quot;&quot;</span>

<span class="sd">    # Initialize Lithium SSO Client</span>
<span class="sd">    from pylithiumsso3.lithium_sso import LithiumSSO</span>

<span class="sd">    lithium = LithiumSSO(&quot;example&quot;, &quot;.example.com&quot;, sso_key)</span>

<span class="sd">    # (Optional) Additional user profile settings to pass to Lithium</span>
<span class="sd">    settings = {}</span>

<span class="sd">    # Example: Set the user&#39;s homepage URL</span>
<span class="sd">    settings[&quot;profile.url_homepage&quot;] = &quot;http://myhomepage.example.com&quot;</span>

<span class="sd">    # Example: Grant the user the Moderator role</span>
<span class="sd">    settings[&quot;roles.grant&quot;] = &quot;Moderator&quot;</span>

<span class="sd">    # Create the authentication token</span>
<span class="sd">    req_user_agent = &quot;Mozilla/5.0&quot;</span>
<span class="sd">    req_referer = &quot;example.com&quot;</span>
<span class="sd">    req_remote_addr = &quot;10.11.12.13&quot;</span>
<span class="sd">    li_token = lithium.get_auth_token_value(</span>
<span class="sd">        &quot;1000&quot;, &quot;myscreenname&quot;, &quot;myemail@example.com&quot;, settings,</span>
<span class="sd">        req_user_agent, req_referer, req_remote_addr</span>
<span class="sd">    )</span>

<span class="sd">    # The token can either be passed directly through HTTP GET/POST, or through cookies.</span>

<span class="sd">    # If PrivacyGuard is enabled, you must initialize the PrivacyGuard key, and call the</span>
<span class="sd">    # encryption function for each token which requires PG encryption. Example:</span>
<span class="sd">    lithium.init_smr(pg_hex_key)</span>
<span class="sd">    pg_enc_parameter = lithium.get_smr_field(&quot;myemail@example.com&quot;);</span>
<span class="sd">    li_token = lithium.get_auth_token_value(&quot;1000&quot;, &quot;myscreenname&quot;, pg_enc_parameter, settings)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">zlib</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">Crypto.Util</span> <span class="kn">import</span> <span class="n">Padding</span>


<div class="viewcode-block" id="LithiumSSO"><a class="viewcode-back" href="../../index.html#pylithiumsso3.lithium_sso.LithiumSSO">[docs]</a><span class="k">class</span> <span class="nc">LithiumSSO</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :ivar client_id: The client or community id to create an SSO token for</span>
<span class="sd">    :ivar client_domain: The domain name for this token, used when transporting via cookies</span>
<span class="sd">        (e.g., &quot;.lithium.com&quot;)</span>
<span class="sd">    :ivar server_id: The server ID</span>
<span class="sd">    :ivar sso_key: The 128-bit or 256-bit secret key bytes</span>
<span class="sd">    :ivar pg_key: The 128-bit or 256-bit PrivacyGuard key bytes</span>
<span class="sd">    :ivar tsid: The timestamp ID</span>

<span class="sd">    :param client_id: The client or community id to create an SSO token for</span>
<span class="sd">    :param client_domain: The domain name for this token, used when transporting via cookies (e.g.,</span>
<span class="sd">        &quot;.lithium.com&quot;)</span>
<span class="sd">    :param sso_hex_key: The 128-bit or 256-bit secret key, represented in hexadecimal</span>
<span class="sd">    :param server_id: The server id</span>
<span class="sd">    :raises: ValueError if invalid client ID, client domain, or SSO key</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Constants</span>
    <span class="n">VALID_KEY_LENGTHS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">LITHIUM_SEPARATOR</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span>
    <span class="n">LITHIUM_SEPARATOR_REPLACE</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">LITHIUM_VERSION</span> <span class="o">=</span> <span class="s2">&quot;LiSSOv1.5&quot;</span>
    <span class="n">VALID_IV_CHARS</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>
    <span class="n">IV_LEN</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">DEFAULT_SERVER_VAR_VALUE</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
    <span class="n">_CRYPTO_PATTERN1</span> <span class="o">=</span> <span class="s2">&quot;+/=&quot;</span>
    <span class="n">_CRYPTO_PATTERN2</span> <span class="o">=</span> <span class="s2">&quot;-_.&quot;</span>
    <span class="n">ENCRYPT_REPLACE</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">_CRYPTO_PATTERN1</span><span class="p">,</span> <span class="n">_CRYPTO_PATTERN2</span><span class="p">)</span>
    <span class="n">DECRYPT_REPLACE</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="n">_CRYPTO_PATTERN2</span><span class="p">,</span> <span class="n">_CRYPTO_PATTERN1</span><span class="p">)</span>
    <span class="n">TOKEN_KEYS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;version&quot;</span><span class="p">,</span>
        <span class="s2">&quot;server_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tsid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;req_user_agent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;req_referer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;req_remote_addr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;client_domain&quot;</span><span class="p">,</span>
        <span class="s2">&quot;client_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;unique_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;login&quot;</span><span class="p">,</span>
        <span class="s2">&quot;email&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="c1"># Allowed pattern for decoding</span>
    <span class="n">DECODE_PATTERN</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;^~2[</span><span class="si">{</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">VALID_IV_CHARS</span><span class="p">)</span><span class="si">}</span><span class="s2">]</span><span class="se">{{</span><span class="si">{</span><span class="n">IV_LEN</span><span class="si">}</span><span class="se">}}</span><span class="s2">~[0-9A-Za-z</span><span class="si">{</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">_CRYPTO_PATTERN2</span><span class="p">)</span><span class="si">}</span><span class="s2">]*$&quot;</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">client_domain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sso_hex_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">server_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">client_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Could not initialize Lithium SSO Client: Client id required&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">client_domain</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Could not initialize Lithium SSO Client: Client domain required&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">client_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_domain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">client_domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_server_id</span><span class="p">(</span><span class="n">server_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sso_key</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_key</span><span class="p">(</span><span class="n">sso_hex_key</span><span class="p">,</span> <span class="s2">&quot;SSO&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pg_key</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tsid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>

<div class="viewcode-block" id="LithiumSSO.get_auth_token_value"><a class="viewcode-back" href="../../index.html#pylithiumsso3.lithium_sso.LithiumSSO.get_auth_token_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_auth_token_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">login</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">settings</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">req_user_agent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">req_referer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">req_remote_addr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a Lithium authentication token for the given user parameters</span>

<span class="sd">        :param unique_id: A non-changable id used to uniquely identify this user globally.</span>
<span class="sd">            This should be an non-reusable integer or other identifier. Email addresses can be</span>
<span class="sd">            used, but are not recommended as this value cannot be changed.</span>
<span class="sd">        :param login: The login name or screen name for this user.  This is usually a publicly</span>
<span class="sd">            visible field, so should not contain personally identifiable information.</span>
<span class="sd">        :param email: The email address for this user.</span>
<span class="sd">        :param settings: Profile settings where the key is the setting name and the value is</span>
<span class="sd">            the setting value. Examples of settings include:</span>

<span class="sd">            * roles.grant = Moderator (grants the Moderator role to user)</span>
<span class="sd">            * profile.name_first = John (sets first name to John)</span>

<span class="sd">            Contact Lithium for a list of valid settings.</span>
<span class="sd">        :param req_user_agent: User agent from request. Used for security identification</span>
<span class="sd">            information.</span>
<span class="sd">        :param req_referer: Referrer from request. Used for security identification information.</span>
<span class="sd">        :param req_remote_addr: Remote address from request. Used for security identification</span>
<span class="sd">            information.</span>
<span class="sd">        :return: the encrypted authentication token</span>
<span class="sd">        :raises: ValueError if invalid unique ID, login, or email</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">unique_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not create Lithium token: Unique id required&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">login</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not create Lithium token: Login name required&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">email</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not create Lithium token: Email address required&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tsid</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;Li&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">LITHIUM_VERSION</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">server_id</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tsid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_server_value</span><span class="p">(</span><span class="n">req_user_agent</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_server_value</span><span class="p">(</span><span class="n">req_referer</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_server_value</span><span class="p">(</span><span class="n">req_remote_addr</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client_domain</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                <span class="n">unique_id</span><span class="p">,</span>
                <span class="n">login</span><span class="p">,</span>
                <span class="n">email</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
            <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;iL&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">LITHIUM_SEPARATOR</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_token_safe_string</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sso_key</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_encode</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an encrypted representation of the specified string.</span>

<span class="sd">        :param value: the string to encode</span>
<span class="sd">        :param key: the key to use</span>
<span class="sd">        :return: the encoded string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">encoded_bytes</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>

        <span class="c1"># gzip compress</span>
        <span class="n">encoded_bytes</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">encoded_bytes</span><span class="p">)</span>

        <span class="c1"># AES encrypt</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">_get_random_iv</span><span class="p">(</span><span class="n">LithiumSSO</span><span class="o">.</span><span class="n">IV_LEN</span><span class="p">)</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">IV</span><span class="o">=</span><span class="n">iv</span><span class="p">)</span>
        <span class="n">encoded_bytes</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">Padding</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">encoded_bytes</span><span class="p">,</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">IV_LEN</span><span class="p">))</span>

        <span class="c1"># URL base64 encode</span>
        <span class="n">encoded_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">encoded_bytes</span><span class="p">)</span>
        <span class="n">encoded_str</span> <span class="o">=</span> <span class="n">encoded_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">LithiumSSO</span><span class="o">.</span><span class="n">ENCRYPT_REPLACE</span><span class="p">)</span>

        <span class="c1"># Version and IV Prefix</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;~2</span><span class="si">{</span><span class="n">iv</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">~</span><span class="si">{</span><span class="n">encoded_str</span><span class="si">}</span><span class="s2">&quot;</span>

<div class="viewcode-block" id="LithiumSSO.decode_auth_token_value"><a class="viewcode-back" href="../../index.html#pylithiumsso3.lithium_sso.LithiumSSO.decode_auth_token_value">[docs]</a>    <span class="k">def</span> <span class="nf">decode_auth_token_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns decoded and parsed Lithium authentication token</span>

<span class="sd">        :param value: Lithium authentication token to decode</span>
<span class="sd">        :return: Dictionary containing the following:</span>

<span class="sd">            * &quot;version&quot; - Lithium token version</span>

<span class="sd">            * &quot;server_id&quot; - The server ID</span>

<span class="sd">            * &quot;tsid&quot; - The timestamp ID</span>

<span class="sd">            * &quot;timestamp&quot; - The timestamp of the request</span>

<span class="sd">            * &quot;req_user_agent&quot; - User agent from request</span>

<span class="sd">            * &quot;req_referer&quot; - Referrer from request</span>

<span class="sd">            * &quot;req_remote_addr&quot; - Remote address from request</span>

<span class="sd">            * &quot;client_domain&quot; - The domain name for this token, used when transporting via</span>
<span class="sd">              cookies (e.g., &quot;.lithium.com&quot;)</span>

<span class="sd">            * &quot;client_id&quot; - The client or community id to create an SSO token for</span>

<span class="sd">            * &quot;unique_id&quot; - A non-changable id used to uniquely identify this user globally</span>

<span class="sd">            * &quot;login&quot; - The login name or screen name for this user</span>

<span class="sd">            * &quot;email&quot; - The email address for this user</span>

<span class="sd">            * &quot;settings&quot; - Profile settings where the key is the setting name and the value is</span>
<span class="sd">              the setting value</span>
<span class="sd">        :raises: ValueError if decoded value of Lithium authentication token is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">decoded_value</span> <span class="o">=</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">_decode</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sso_key</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">decoded_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LITHIUM_SEPARATOR</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TOKEN_KEYS</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Li&quot;</span>
            <span class="ow">or</span> <span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;iL&quot;</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not decode Lithium token: Invalid format&quot;</span><span class="p">)</span>

        <span class="c1"># Parse non-settings items (strip off &quot;Li&quot; and &quot;iL&quot;</span>
        <span class="n">parsed_items</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TOKEN_KEYS</span><span class="p">,</span> <span class="n">items</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;req_&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">item</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_SERVER_VAR_VALUE</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="n">parsed_items</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>

        <span class="c1"># Parse settings items</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TOKEN_KEYS</span><span class="p">)</span> <span class="p">:]:</span>
            <span class="n">settings_key</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">settings_value</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="p">[</span><span class="n">settings_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings_value</span>

        <span class="n">parsed_items</span><span class="p">[</span><span class="s2">&quot;settings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span>
        <span class="k">return</span> <span class="n">parsed_items</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_decode</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an decrypted representation of the specified string.</span>

<span class="sd">        :param value: the string to decode</span>
<span class="sd">        :param key: the key to use</span>
<span class="sd">        :return: the decoded string</span>
<span class="sd">        :raises: ValueError if invalid string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">DECODE_PATTERN</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not decode Lithium token: Invalid format&quot;</span><span class="p">)</span>

        <span class="n">parts</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="n">decoded_str</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># URL base64 decode</span>
        <span class="n">decoded_str</span> <span class="o">=</span> <span class="n">decoded_str</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">LithiumSSO</span><span class="o">.</span><span class="n">DECRYPT_REPLACE</span><span class="p">)</span>
        <span class="n">decoded_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">decoded_str</span><span class="p">)</span>

        <span class="c1"># AES decrypt</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">IV</span><span class="o">=</span><span class="n">iv</span><span class="p">)</span>
        <span class="n">decoded_bytes</span> <span class="o">=</span> <span class="n">Padding</span><span class="o">.</span><span class="n">unpad</span><span class="p">(</span><span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">decoded_bytes</span><span class="p">),</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">IV_LEN</span><span class="p">)</span>

        <span class="c1"># zlib decompress</span>
        <span class="n">decoded_bytes</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">decoded_bytes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">decoded_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parse_key</span><span class="p">(</span><span class="n">hex_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse encryption key</span>

<span class="sd">        :param hex_key: Encryption key in hexadecimal</span>
<span class="sd">        :param key_type: Key type to use in error message (e.g., &quot;SSO&quot;)</span>
<span class="sd">        :return: Encyption key</span>
<span class="sd">        :value: ValueError if key is not 128-bit or 256-bit</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">hex_key</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key_type</span><span class="si">}</span><span class="s2"> Hex key required&quot;</span><span class="p">)</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">hex_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">VALID_KEY_LENGTHS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key_type</span><span class="si">}</span><span class="s2"> key must be 128-bit or 256-bit in length&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">key</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_random_iv</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a random initialization vector for AES with the specified length.</span>
<span class="sd">        The returned string is URL-safe.</span>

<span class="sd">        :param length: the length of the IV to return, in bytes</span>
<span class="sd">        :return: string the IV in string form</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">LithiumSSO</span><span class="o">.</span><span class="n">VALID_IV_CHARS</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_token_safe_string</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a token-safe representation of the specified string. Used to ensure that</span>
<span class="sd">        the token separator is not used inside a token.</span>

<span class="sd">        :param value: the string to return a token-safe representation for</span>
<span class="sd">        :return: String the token-safe representation of $string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">LITHIUM_SEPARATOR</span><span class="p">,</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">LITHIUM_SEPARATOR_REPLACE</span>
        <span class="p">)</span>

<div class="viewcode-block" id="LithiumSSO.init_smr"><a class="viewcode-back" href="../../index.html#pylithiumsso3.lithium_sso.LithiumSSO.init_smr">[docs]</a>    <span class="k">def</span> <span class="nf">init_smr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pg_hex_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PrivacyGuard key init</span>

<span class="sd">        :param pg_hex_key: The 128-bit or 256-bit PrivacyGuard key, represented in hexadecimal</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pg_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_key</span><span class="p">(</span><span class="n">pg_hex_key</span><span class="p">,</span> <span class="s2">&quot;PG&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="LithiumSSO.get_smr_field"><a class="viewcode-back" href="../../index.html#pylithiumsso3.lithium_sso.LithiumSSO.get_smr_field">[docs]</a>    <span class="k">def</span> <span class="nf">get_smr_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PrivacyGuard parameter encrypt</span>

<span class="sd">        :param value: the string to return a PrivacyGuard encrypted token for</span>
<span class="sd">        :return: the PrivacyGuard encrypted value of string or &quot;&quot; if no key set</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pg_key</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pg_key</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="LithiumSSO.decode_smr_field"><a class="viewcode-back" href="../../index.html#pylithiumsso3.lithium_sso.LithiumSSO.decode_smr_field">[docs]</a>    <span class="k">def</span> <span class="nf">decode_smr_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PrivacyGuard parameter decrypt</span>

<span class="sd">        :param value: the string to return a PrivacyGuard decrypted token for</span>
<span class="sd">        :return: the PrivacyGuard decrypted value of string or &quot;&quot; if no key set</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pg_key</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pg_key</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_server_value</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get server value</span>

<span class="sd">        :param value: Server value</span>
<span class="sd">        :return: Server value or &quot; &quot; if empty</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">value</span> <span class="ow">or</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">DEFAULT_SERVER_VAR_VALUE</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parse_server_id</span><span class="p">(</span><span class="n">server_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse server ID</span>

<span class="sd">        :param server_id: Server ID</span>
<span class="sd">        :return: Converted server ID</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">server_id</span> <span class="o">=</span> <span class="n">server_id</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">server_id</span><span class="p">:</span>
            <span class="n">server_id</span> <span class="o">=</span> <span class="n">LithiumSSO</span><span class="o">.</span><span class="n">_get_token_safe_string</span><span class="p">(</span><span class="n">server_id</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">server_id</span> <span class="o">=</span> <span class="s2">&quot;34&quot;</span>  <span class="c1"># This is the default value that lithium_sso.php uses</span>

        <span class="n">hex_string</span> <span class="o">=</span> <span class="n">_get_random_hex_string</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">server_id</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">hex_string</span><span class="si">}</span><span class="s2">&quot;</span></div>


<span class="k">def</span> <span class="nf">_get_random_hex_string</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="si">:</span><span class="s2">02X</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Lithium Technologies.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>